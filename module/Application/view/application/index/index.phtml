<div class="jumbotron">
    <h1>Bienvenue sur le <span class="zf-green">ZF2 Blog App</span>&nbsp;!</h1>
</div>

<div class="row">
    <div class="col-md-8">
        <?php 
        foreach($this->post as $post)
        {     
            ?>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <a href="<?php echo $this->url('post', array('action' => 'view', 'pid' => $post['id'])); ?>"><?php echo $post['title']; ?></a>
                        <span class="pull-right">par <strong><?php echo $post['author']['username']; ?></strong></span>
                    </h3>
                </div>
                <div class="panel-body">
                    <p>
                        <?php
                        if(strlen($post['content']) > 300) echo nl2br(substr($post['content'], 0, 300)).' […]';
                        else echo nl2br($post['content']);
                        ?>
                    </p>
                    <p><a class="btn btn-success pull-right" href="<?php echo $this->url('post', array('action' => 'view', 'pid' => $post['id'])); ?>">Lire la suite &raquo;</a></p>
                </div>
                <div class="panel-footer">
                    <p class="panel-title"><span class="zf-green">Posté le <?php $date = $post['date_create']; echo $date->format('d\/m\/Y\ \à\ H\:i'); ?></span><img class="pull-right" src="<?php echo $this->basePath('img/zf2-logo.png') ?>" alt="ZF2" /></p>
                </div>
            </div>
            <?php
        }
        ?>

        <div class="text-center">
            <ul class="pagination">
                <?php
                // Page précédente
                if($this->page == 1) {
                    echo '<li class="disabled"><a href="#">&laquo;</a></li>';
                }
                else {
                    echo '<li><a href="'.$this->url('home', array('page' => ($this->page - 1))).'">&laquo;</a></li>';
                }

                // Liste des pages
                for($i = 1; $i <= $nb_pages; ++$i) {
                    echo '<li'.(($i == $this->page) ? ' class="active"' : '').'>'
                       . '<a href="'.$this->url('home', array('page' => $i)).'">'.$i.'</a>'
                       . '</li>';
                }

                // Page suivante
                if($this->page == $this->nb_pages) {
                    echo '<li class="disabled"><a href="#">&raquo;</a></li>';
                }
                else {
                    echo '<li><a href="'.$this->url('home', array('page' => ($this->page + 1))).'">&raquo;</a></li>';
                }
                ?>
            </ul>
        </div>
    </div>

    <div class="col-md-4">
        <div class="panel panel-success">
            <div class="panel-heading">
                <h3 class="panel-title">Menu</h3>
            </div>
            <div class="panel-body">
                <?php
                if($this->zfcUserIdentity()) {
                    ?>
                    <p class="text-center"><b><?php echo $this->zfcUserIdentity()->getEmail(); ?></b></p>
                    <p class="text-center"><?php echo $this->gravatar($this->zfcUserIdentity()->getEmail()); ?></p>
                    <p class="text-center"><a class="btn btn-success" href="">Ajouter un billet</a></p>
                    <hr />
                    <?php
                }
                ?>

                <h3>Recherche</h3>
                <form class="form-inline" method="post" action="<?php echo $this->url('search'); ?>" role="form">
                    <div class="form-group">
                        <input id="tag" class="form-control" name="tag" type="text" placeholder="Recherche…" />
                    </div>
                    <div class="form-group">
                        <input type="submit" value="OK" class="btn btn-default" />
                    </div>
                </form>
                <hr />

                <!-- Exemples de tags, TODO: à générer -->
                <h3>Tags populaires</h3>
                <p>
                    <a href="<?php echo $this->url('search', array('tag' => 'lolcat')); ?>">lolcat</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'panda')); ?>">panda</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'pingouin')); ?>">pingouin</a>
                    <a href="<?php echo $this->url('search', array('tag' => 'yolo')); ?>">yolo</a>
                    <a href="<?php echo $this->url('search', array('tag' => 'lolcat')); ?>">lolcat</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'panda')); ?>">panda</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'pingouin')); ?>">pingouin</a>
                    <a href="<?php echo $this->url('search', array('tag' => 'yolo')); ?>">yolo</a>
                    <a href="<?php echo $this->url('search', array('tag' => 'lolcat')); ?>">lolcat</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'panda')); ?>">panda</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'pingouin')); ?>">pingouin</a>
                    <a href="<?php echo $this->url('search', array('tag' => 'yolo')); ?>">yolo</a>
                    <a href="<?php echo $this->url('search', array('tag' => 'lolcat')); ?>">lolcat</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'panda')); ?>">panda</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'pingouin')); ?>">pingouin</a>
                    <a href="<?php echo $this->url('search', array('tag' => 'yolo')); ?>">yolo</a>
                    <a href="<?php echo $this->url('search', array('tag' => 'lolcat')); ?>">lolcat</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'panda')); ?>">panda</a> 
                    <a href="<?php echo $this->url('search', array('tag' => 'pingouin')); ?>">pingouin</a>
                    <a href="<?php echo $this->url('search', array('tag' => 'yolo')); ?>">yolo</a>
                </p>
            </div>
        </div>
    </div>
</div>